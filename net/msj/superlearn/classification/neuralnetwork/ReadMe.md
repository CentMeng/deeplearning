# 神经网络算法 Neural Network

## 1.背景

- 1.1 以人脑中的神经网络为启发
- 1.2 最著名的算法是1980年的backpropagation

## 2.多层向前神经网络（Multilayer Feed-Forward Neural Network）
- 2.1 Backpropagation被使用在多层向前神经网络上
- 2.2 多层向前神经网络由以下部分组成：
  - 输入层（Input Layer）
  - 隐藏层（Hidden Layer)
  - 输出层（Output Layer）
  
  <img src = "img/1.jpg">

- 2.3 每层由单元（units）组成
- 2.4 输入层是由训练集的实例特征向量传入
- 2.5 经过连接结点的权重传入下一层，一层的输出是下一层的输入
- 2.6 隐藏层的个数是随意的，输入层有一层，输出层有一层
- 2.7 每个单元也可以被称作神经节点，根据生物学来源定义
- 2.8 以上称为2层神经网络（输入层不算）
- 2.9 一层中加权的求和，然后根据非线性方程转化输出
- 2.10 作为多层向前神经网络，理论上，如果有足够多的隐藏层和足够大的训练集，可以模拟出任何方程

## 3.设计神经网络结构
- 3.1 使用神经网络训练数据之前，需先确认神经网络的层数，以及每层的单元个数
- 3.2 特征向量在被传入输入层时通常先被标准化（normalize）到0和1之间（为了加速学习过程）
- 3.3 离散型变量可以被编码成每一个输入单元对应一个特征值可能赋的值
> 比如：特征值A可能取三个值（a0，a1，a2），可以使用3个输入单元来代表A

> 如果A=a0，那么代表a0的单元值就取1，其他取0；

> 如果A=a1，那么代表a1的单元值就取1，其他取0，以此类推。

- 3.4 神经网络即可以用来做分类问题，又可以解决回归问题。
  - 3.4.1 对于分类问题，如果是2类，可以用一个输入单元表示（0和1分别代表2类）
         如果多于2类，每一个类别用一个输入单元表示
         所以输入层的单元数量通常等于类别数量
  - 3.4.2 没有明确的规则设计最好有多少个隐藏层
        根据实验测试和误差，以及准确度来实验并改进

## 4.交叉验证方法

<img src="img/2.jpg">

## 5.Backpropagation算法

- 5.1 通过迭代性来处理训练集中的实例
- 5.2 对比经过神经网络后输入层预测值与真实值之间的差距
- 5.3 反方向（从输出层=>隐藏层=>输入层）来以最小化误差来更新每个连接的权重
- 5.4 算法详细介绍
     输入：D：数据集，|学习率（learning rate），一个多层前向神经网络
     输出：一个训练好的神经网络
  - 5.4.1 初始化权重和偏向（bias）：随机初始化在-1到1之间，或者-0.5到0.5之间，每个单元有一个偏向
  - 5.4.2 对于每一个训练示例X，执行以下步骤：
	
	5.4.2.1 由输入层向前传送

<img src = "img/3.jpg">

> 非线性转化

<img src = "img/4.jpg">

<img src = "img/5.jpg">

<img src = "img/6.jpg">

 5.4.2.2 根据误差（error）反向传送 （O<sub>j</sub>是这一层的预测值，T<sub>j</sub>是真实值）

   > 对于输出层：Errj = O<sub>i</sub>(1-O<sub>j</sub>)(T<sub>j</sub>-O<sub>j</sub>)

   > 对于隐藏层：Errj = O<sub>j</sub>(1-O<sub>j</sub>）Σ<sub>k</sub>Err<sub>k</sub>W<sub>jk</sub>（K代表前面一层；前面一层的误差乘以权重的积）
   
<img src = "img/7.jpg">

> l是学习率（取值在0到1，相当于梯度下降算法的下降率）

  - 5.4.3 终止条件
	
	5.4.3.1 权重的更新低于某个阀值
    
    5.4.3.2 预测的错误率低于某个阀值
    
    5.4.3.3 达到预设一定的循环次数

## 6.Backpropagation算法举例

- 第一步：  由输入层向前传送

<img src = "img/8.jpg">

<img src = "img/9.jpg">

其中圆球中4，5，6代表θ<sub>4</sub>，θ<sub>5</sub>，θ<sub>6</sub> 即偏向

- 第二步：根据误差（error）反向传送 ，偏向更新取0.9

<img src = "img/10.jpg">
